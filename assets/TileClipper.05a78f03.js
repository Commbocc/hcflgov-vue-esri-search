import{J as mi,aQ as di}from"./index.6518a001.js";import{U as gi,e as at,n as it,o as pi}from"./enums.94a84b2b.js";import{t as Y,s as dt}from"./Geometry.e891c191.js";class ms{constructor(e=0,n=0,l=0,a=0){this.x=e,this.y=n,this.width=l,this.height=a}get isEmpty(){return this.width<=0||this.height<=0}union(e){this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.width=Math.max(this.width,e.width),this.height=Math.max(this.height,e.height)}}const Ti=128e3;let Yt=null,li=null;async function ds(){return Yt||(Yt=_i()),Yt}async function _i(){li=await(mi("esri-csp-restrictions")?await import("./libtess-asm.a9e3d90a.js").then(e=>e.l):await import("./libtess.7f5ceffa.js").then(e=>e.l)).load({locateFile:()=>di("esri/core/libs/libtess/libtess.wasm")})}function gs(h,e){const n=Math.max(h.length,Ti);return li.triangulate(h,e,n)}function ai(h,e){return h.x===e.x&&h.y===e.y}function Li(h){if(!h)return;const e=h.length;if(e<=1)return;let n=0;for(let l=1;l<e;l++)ai(h[l],h[n])||++n===l||(h[n]=h[l]);h.length=n+1}function H(h,e){return h.x=e.y,h.y=-e.x,h}function X(h,e){return h.x=-e.y,h.y=e.x,h}function Kt(h,e){return h.x=e.x,h.y=e.y,h}function Jt(h,e){return h.x=-e.x,h.y=-e.y,h}function Zt(h){return Math.sqrt(h.x*h.x+h.y*h.y)}function wi(h,e){return h.x*e.y-h.y*e.x}function ti(h,e){return h.x*e.x+h.y*e.y}function Lt(h,e,n,l){return h.x=e.x*n+e.y*l,h.y=e.x*l-e.y*n,h}class ps{constructor(e,n,l){this.writeVertex=e,this.writeTriangle=n,this.canUseThinTessellation=l,this.prevNormal={x:void 0,y:void 0},this.nextNormal={x:void 0,y:void 0},this.textureNormalLeft={x:0,y:1},this.textureNormalRight={x:0,y:-1},this.textureNormal={x:void 0,y:void 0},this.joinNormal={x:void 0,y:void 0},this.inner={x:void 0,y:void 0},this.outer={x:void 0,y:void 0},this.roundStart={x:void 0,y:void 0},this.roundEnd={x:void 0,y:void 0},this.startBreak={x:void 0,y:void 0},this.endBreak={x:void 0,y:void 0},this.innerPrev={x:void 0,y:void 0},this.innerNext={x:void 0,y:void 0},this.bevelStart={x:void 0,y:void 0},this.bevelEnd={x:void 0,y:void 0},this.bevelMiddle={x:void 0,y:void 0}}tessellate(e,n){Li(e),this.canUseThinTessellation&&n.halfWidth<gi&&!n.offset?this._tessellateThin(e,n):this._tessellate(e,n)}_tessellateThin(e,n){if(e.length<2)return;const l=n.wrapDistance||65535;let a=n.initialDistance||0,o=!1,u=e[0].x,f=e[0].y;const c=e.length;for(let d=1;d<c;++d){o&&(o=!1,a=0);let A=e[d].x,B=e[d].y,w=A-u,v=B-f,g=Math.sqrt(w*w+v*v);if(w/=g,v/=g,a+g>l){o=!0;const y=(l-a)/g;g=l-a,A=(1-y)*u+y*A,B=(1-y)*f+y*B,--d}const T=this.writeVertex(u,f,0,0,w,v,v,-w,0,-1,a),R=this.writeVertex(u,f,0,0,w,v,-v,w,0,1,a);a+=g;const b=this.writeVertex(A,B,0,0,w,v,v,-w,0,-1,a),m=this.writeVertex(A,B,0,0,w,v,-v,w,0,1,a);this.writeTriangle(T,R,b),this.writeTriangle(R,b,m),u=A,f=B}}_tessellate(e,n){const l=e[0],a=e[e.length-1],o=ai(l,a),u=o?3:2;if(e.length<u)return;const f=n.pixelCoordRatio,c=n.capType!=null?n.capType:at.BUTT,d=n.joinType!=null?n.joinType:it.MITER,A=n.miterLimit!=null?Math.min(n.miterLimit,4):2,B=n.roundLimit!=null?Math.min(n.roundLimit,1.05):1.05,w=n.halfWidth!=null?n.halfWidth:2,v=!!n.textured;let g,T,R=null,b=null;const m=this.prevNormal,y=this.nextNormal;let gt=-1,xt=-1;const N=this.joinNormal;let M,$;const Nt=this.textureNormalLeft,Ft=this.textureNormalRight,k=this.textureNormal;let P=-1,S=-1;const qt=n.wrapDistance||65535;let V=n.initialDistance||0;const ci=this.writeVertex,fi=this.writeTriangle,I=function(J,St,ft,j,tt,nt){const ht=ci(g,T,M,$,ft,j,J,St,tt,nt,V);return P>=0&&S>=0&&ht>=0&&fi(P,S,ht),P=S,S=ht,ht};o&&(R=e[e.length-2],y.x=a.x-R.x,y.y=a.y-R.y,xt=Zt(y),y.x/=xt,y.y/=xt);let pt=!1;for(let J=0;J<e.length;++J){if(pt&&(pt=!1,V=0),R&&(m.x=-y.x,m.y=-y.y,gt=xt,V+gt>qt&&(pt=!0)),pt){const U=(qt-V)/gt;gt=qt-V,R={x:(1-U)*R.x+U*e[J].x,y:(1-U)*R.y+U*e[J].y},--J}else R=e[J];g=R.x,T=R.y;const St=J<=0&&!pt,ft=J===e.length-1;if(St||(V+=gt),b=ft?o?e[1]:null:e[J+1],b?(y.x=b.x-g,y.y=b.y-T,xt=Zt(y),y.x/=xt,y.y/=xt):(y.x=void 0,y.y=void 0),!o){if(St){X(N,y),M=N.x,$=N.y,c===at.SQUARE&&(I(-y.y-y.x,y.x-y.y,y.x,y.y,0,-1),I(y.y-y.x,-y.x-y.y,y.x,y.y,0,1)),c===at.ROUND&&(I(-y.y-y.x,y.x-y.y,y.x,y.y,-1,-1),I(y.y-y.x,-y.x-y.y,y.x,y.y,-1,1)),c!==at.ROUND&&c!==at.BUTT||(I(-y.y,y.x,y.x,y.y,0,-1),I(y.y,-y.x,y.x,y.y,0,1));continue}if(ft){H(N,m),M=N.x,$=N.y,c!==at.ROUND&&c!==at.BUTT||(I(m.y,-m.x,-m.x,-m.y,0,-1),I(-m.y,m.x,-m.x,-m.y,0,1)),c===at.SQUARE&&(I(m.y-m.x,-m.x-m.y,-m.x,-m.y,0,-1),I(-m.y-m.x,m.x-m.y,-m.x,-m.y,0,1)),c===at.ROUND&&(I(m.y-m.x,-m.x-m.y,-m.x,-m.y,1,-1),I(-m.y-m.x,m.x-m.y,-m.x,-m.y,1,1));continue}}let j,tt,nt=-wi(m,y);if(Math.abs(nt)<.01)ti(m,y)>0?(N.x=m.x,N.y=m.y,nt=1,j=Number.MAX_VALUE,tt=!0):(X(N,y),nt=1,j=1,tt=!1);else{N.x=(m.x+y.x)/nt,N.y=(m.y+y.y)/nt,j=Zt(N);const U=(j-1)*w*f;tt=j>4||U>gt&&U>xt}M=N.x,$=N.y;let ht=d;switch(d){case it.BEVEL:j<1.05&&(ht=it.MITER);break;case it.ROUND:j<B&&(ht=it.MITER);break;case it.MITER:j>A&&(ht=it.BEVEL)}switch(ht){case it.MITER:if(I(N.x,N.y,-m.x,-m.y,0,-1),I(-N.x,-N.y,-m.x,-m.y,0,1),ft)break;if(v){const U=pt?0:V;P=this.writeVertex(g,T,M,$,y.x,y.y,N.x,N.y,0,-1,U),S=this.writeVertex(g,T,M,$,y.x,y.y,-N.x,-N.y,0,1,U)}break;case it.BEVEL:{const U=nt<0;let C,z,ut,Z;if(U){const E=P;P=S,S=E,C=Nt,z=Ft}else C=Ft,z=Nt;if(tt)ut=U?X(this.innerPrev,m):H(this.innerPrev,m),Z=U?H(this.innerNext,y):X(this.innerNext,y);else{const E=U?Jt(this.inner,N):Kt(this.inner,N);ut=E,Z=E}const G=U?H(this.bevelStart,m):X(this.bevelStart,m);I(ut.x,ut.y,-m.x,-m.y,C.x,C.y);const Vt=I(G.x,G.y,-m.x,-m.y,z.x,z.y);if(ft)break;const rt=U?X(this.bevelEnd,y):H(this.bevelEnd,y);if(tt){const E=this.writeVertex(g,T,M,$,-m.x,-m.y,0,0,0,0,V);P=this.writeVertex(g,T,M,$,y.x,y.y,Z.x,Z.y,C.x,C.y,V),S=this.writeVertex(g,T,M,$,y.x,y.y,rt.x,rt.y,z.x,z.y,V),this.writeTriangle(Vt,E,S)}else{if(v){const E=this.bevelMiddle;E.x=(G.x+rt.x)/2,E.y=(G.y+rt.y)/2,Lt(k,E,-m.x,-m.y),I(E.x,E.y,-m.x,-m.y,k.x,k.y),Lt(k,E,y.x,y.y),P=this.writeVertex(g,T,M,$,y.x,y.y,E.x,E.y,k.x,k.y,V),S=this.writeVertex(g,T,M,$,y.x,y.y,Z.x,Z.y,C.x,C.y,V)}else{const E=P;P=S,S=E}I(rt.x,rt.y,y.x,y.y,z.x,z.y)}if(U){const E=P;P=S,S=E}break}case it.ROUND:{const U=nt<0;let C,z;if(U){const q=P;P=S,S=q,C=Nt,z=Ft}else C=Ft,z=Nt;const ut=U?Jt(this.inner,N):Kt(this.inner,N);let Z,G;tt?(Z=U?X(this.innerPrev,m):H(this.innerPrev,m),G=U?H(this.innerNext,y):X(this.innerNext,y)):(Z=ut,G=ut);const Vt=U?H(this.roundStart,m):X(this.roundStart,m),rt=U?X(this.roundEnd,y):H(this.roundEnd,y),E=I(Z.x,Z.y,-m.x,-m.y,C.x,C.y),Et=I(Vt.x,Vt.y,-m.x,-m.y,z.x,z.y);if(ft)break;const yt=this.writeVertex(g,T,M,$,-m.x,-m.y,0,0,0,0,V);tt||this.writeTriangle(P,S,yt);const lt=Jt(this.outer,ut),mt=this.writeVertex(g,T,M,$,y.x,y.y,rt.x,rt.y,z.x,z.y,V);let Tt,_t;const Mt=j>2;if(Mt){let q;j!==Number.MAX_VALUE?(lt.x/=j,lt.y/=j,q=ti(m,lt),q=(j*(q*q-1)+1)/q):q=-1,Tt=U?H(this.startBreak,m):X(this.startBreak,m),Tt.x+=m.x*q,Tt.y+=m.y*q,_t=U?X(this.endBreak,y):H(this.endBreak,y),_t.x+=y.x*q,_t.y+=y.y*q}Lt(k,lt,-m.x,-m.y);const $t=this.writeVertex(g,T,M,$,-m.x,-m.y,lt.x,lt.y,k.x,k.y,V);Lt(k,lt,y.x,y.y);const Qt=v?this.writeVertex(g,T,M,$,y.x,y.y,lt.x,lt.y,k.x,k.y,V):$t,Xt=yt,Pt=v?this.writeVertex(g,T,M,$,y.x,y.y,0,0,0,0,V):yt;let At=-1,Rt=-1;if(Mt&&(Lt(k,Tt,-m.x,-m.y),At=this.writeVertex(g,T,M,$,-m.x,-m.y,Tt.x,Tt.y,k.x,k.y,V),Lt(k,_t,y.x,y.y),Rt=this.writeVertex(g,T,M,$,y.x,y.y,_t.x,_t.y,k.x,k.y,V)),v?Mt?(this.writeTriangle(Xt,Et,At),this.writeTriangle(Xt,At,$t),this.writeTriangle(Pt,Qt,Rt),this.writeTriangle(Pt,Rt,mt)):(this.writeTriangle(Xt,Et,$t),this.writeTriangle(Pt,Qt,mt)):Mt?(this.writeTriangle(yt,Et,At),this.writeTriangle(yt,At,Rt),this.writeTriangle(yt,Rt,mt)):(this.writeTriangle(yt,Et,$t),this.writeTriangle(yt,Qt,mt)),tt?(P=this.writeVertex(g,T,M,$,y.x,y.y,G.x,G.y,C.x,C.y,V),S=mt):(P=v?this.writeVertex(g,T,M,$,y.x,y.y,G.x,G.y,C.x,C.y,V):E,this.writeTriangle(P,Pt,mt),S=mt),U){const q=P;P=S,S=q}break}}}}}const It=[["(",")"],[")","("],["<",">"],[">","<"],["[","]"],["]","["],["{","}"],["}","{"],["\xAB","\xBB"],["\xBB","\xAB"],["\u2039","\u203A"],["\u203A","\u2039"],["\u207D","\u207E"],["\u207E","\u207D"],["\u208D","\u208E"],["\u208E","\u208D"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232A"],["\u232A","\u2329"],["\uFE59","\uFE5A"],["\uFE5A","\uFE59"],["\uFE5B","\uFE5C"],["\uFE5C","\uFE5B"],["\uFE5D","\uFE5E"],["\uFE5E","\uFE5D"],["\uFE64","\uFE65"],["\uFE65","\uFE64"]],vt=["\u0622","\u0623","\u0625","\u0627"],vi=["\uFEF5","\uFEF7","\uFEF9","\uFEFB"],Ai=["\uFEF6","\uFEF8","\uFEFA","\uFEFC"],Ot=["\u0627","\u0628","\u062A","\u062B","\u062C","\u062D","\u062E","\u062F","\u0630","\u0631","\u0632","\u0633","\u0634","\u0635","\u0636","\u0637","\u0638","\u0639","\u063A","\u0641","\u0642","\u0643","\u0644","\u0645","\u0646","\u0647","\u0648","\u064A","\u0625","\u0623","\u0622","\u0629","\u0649","\u0644","\u0645","\u0646","\u0647","\u0648","\u064A","\u0625","\u0623","\u0622","\u0629","\u0649","\u06CC","\u0626","\u0624"],Ri=["\uFE8D","\uFE8F","\uFE95","\uFE99","\uFE9D","\uFEA1","\uFEA5","\uFEA9","\uFEAB","\uFEAD","\uFEAF","\uFEB1","\uFEB5","\uFEB9","\uFEBD","\uFEC1","\uFEC5","\uFEC9","\uFECD","\uFED1","\uFED5","\uFED9","\uFEDD","\uFEE1","\uFEE5","\uFEE9","\uFEED","\uFEF1","\uFE87","\uFE83","\uFE81","\uFE93","\uFEEF","\uFBFC","\uFE89","\uFE85","\uFE70","\uFE72","\uFE74","\uFE76","\uFE78","\uFE7A","\uFE7C","\uFE7E","\uFE80","\uFE89","\uFE85"],bi=["\uFE8E","\uFE90","\uFE96","\uFE9A","\uFE9E","\uFEA2","\uFEA6","\uFEAA","\uFEAC","\uFEAE","\uFEB0","\uFEB2","\uFEB6","\uFEBA","\uFEBE","\uFEC2","\uFEC6","\uFECA","\uFECE","\uFED2","\uFED6","\uFEDA","\uFEDE","\uFEE2","\uFEE6","\uFEEA","\uFEEE","\uFEF2","\uFE88","\uFE84","\uFE82","\uFE94","\uFEF0","\uFBFD","\uFE8A","\uFE86","\uFE70","\uFE72","\uFE74","\uFE76","\uFE78","\uFE7A","\uFE7C","\uFE7E","\uFE80","\uFE8A","\uFE86"],Bi=["\uFE8E","\uFE92","\uFE98","\uFE9C","\uFEA0","\uFEA4","\uFEA8","\uFEAA","\uFEAC","\uFEAE","\uFEB0","\uFEB4","\uFEB8","\uFEBC","\uFEC0","\uFEC4","\uFEC8","\uFECC","\uFED0","\uFED4","\uFED8","\uFEDC","\uFEE0","\uFEE4","\uFEE8","\uFEEC","\uFEEE","\uFEF4","\uFE88","\uFE84","\uFE82","\uFE94","\uFEF0","\uFBFF","\uFE8C","\uFE86","\uFE71","\uFE72","\uFE74","\uFE77","\uFE79","\uFE7B","\uFE7D","\uFE7F","\uFE80","\uFE8C","\uFE86"],Ui=["\uFE8D","\uFE91","\uFE97","\uFE9B","\uFE9F","\uFEA3","\uFEA7","\uFEA9","\uFEAB","\uFEAD","\uFEAF","\uFEB3","\uFEB7","\uFEBB","\uFEBF","\uFEC3","\uFEC7","\uFECB","\uFECF","\uFED3","\uFED7","\uFEDB","\uFEDF","\uFEE3","\uFEE7","\uFEEB","\uFEED","\uFEF3","\uFE87","\uFE83","\uFE81","\uFE93","\uFEEF","\uFBFE","\uFE8B","\uFE85","\uFE70","\uFE72","\uFE74","\uFE76","\uFE78","\uFE7A","\uFE7C","\uFE7E","\uFE80","\uFE8B","\uFE85"],ii=["\u0621","\u0622","\u0623","\u0624","\u0625","\u0627","\u0629","\u062F","\u0630","\u0631","\u0632","\u0648","\u0649"],Ni=["\u064B","\u064B","\u064C","\u061F","\u064D","\u061F","\u064E","\u064E","\u064F","\u064F","\u0650","\u0650","\u0651","\u0651","\u0652","\u0652","\u0621","\u0622","\u0622","\u0623","\u0623","\u0624","\u0624","\u0625","\u0625","\u0626","\u0626","\u0626","\u0626","\u0627","\u0627","\u0628","\u0628","\u0628","\u0628","\u0629","\u0629","\u062A","\u062A","\u062A","\u062A","\u062B","\u062B","\u062B","\u062B","\u062C","\u062C","\u062C","\u062C","\u062D","\u062D","\u062D","\u062D","\u062E","\u062E","\u062E","\u062E","\u062F","\u062F","\u0630","\u0630","\u0631","\u0631","\u0632","\u0632","\u0633","\u0633","\u0633","\u0633","\u0634","\u0634","\u0634","\u0634","\u0635","\u0635","\u0635","\u0635","\u0636","\u0636","\u0636","\u0636","\u0637","\u0637","\u0637","\u0637","\u0638","\u0638","\u0638","\u0638","\u0639","\u0639","\u0639","\u0639","\u063A","\u063A","\u063A","\u063A","\u0641","\u0641","\u0641","\u0641","\u0642","\u0642","\u0642","\u0642","\u0643","\u0643","\u0643","\u0643","\u0644","\u0644","\u0644","\u0644","\u0645","\u0645","\u0645","\u0645","\u0646","\u0646","\u0646","\u0646","\u0647","\u0647","\u0647","\u0647","\u0648","\u0648","\u0649","\u0649","\u064A","\u064A","\u064A","\u064A","\uFEF5","\uFEF6","\uFEF7","\uFEF8","\uFEF9","\uFEFA","\uFEFB","\uFEFC","\u061F","\u061F","\u061F"],si=["\u0621","\u0641"],Fi=["\u063A","\u064A"],Si=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],Vi=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],s=0,x=1,_=2,F=3,t=4,et=5,Ct=6,i=7,O=8,W=9,K=10,L=11,r=12,Ei=13,Mi=14,$i=15,Pi=16,Ii=17,p=18,ki=["UBAT_L","UBAT_R","UBAT_EN","UBAT_AN","UBAT_ON","UBAT_B","UBAT_S","UBAT_AL","UBAT_WS","UBAT_CS","UBAT_ES","UBAT_ET","UBAT_NSM","UBAT_LRE","UBAT_RLE","UBAT_PDF","UBAT_LRO","UBAT_RLO","UBAT_BN"],st=100,Di=[st+0,s,s,s,s,st+1,st+2,st+3,x,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,st+4,t,t,t,s,t,s,t,s,t,t,t,s,s,t,t,s,s,s,s,s,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,s,s,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,s,s,s,s,s,s,s,s,s,s,s,s,s,s,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,s,s,t,t,s,s,t,t,s,s,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,s,s,s,st+5,i,i,st+6,st+7],Ci=[[p,p,p,p,p,p,p,p,p,Ct,et,Ct,O,et,p,p,p,p,p,p,p,p,p,p,p,p,p,p,et,et,et,Ct,O,t,t,L,L,L,t,t,t,t,t,K,W,K,W,W,_,_,_,_,_,_,_,_,_,_,W,t,t,t,t,t,t,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,t,t,t,t,t,t,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,t,t,t,t,p,p,p,p,p,p,et,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,W,t,L,L,L,L,t,t,t,t,s,t,t,p,t,t,L,L,_,_,t,s,t,t,t,_,s,t,t,t,t,t,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,t,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,t,s,s,s,s,s,s,s,s],[s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,t,t,t,t,t,t,t,t,t,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,t,t,s,s,s,s,s,s,s,t,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,t,s,t,t,t,t,t,t,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,x,r,x,r,r,x,r,r,x,r,t,t,t,t,t,t,t,t,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,t,t,t,t,t,x,x,x,x,x,t,t,t,t,t,t,t,t,t,t,t],[F,F,F,F,t,t,t,t,i,L,L,i,W,i,t,t,r,r,r,r,r,r,r,r,r,r,r,i,t,t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,F,F,F,F,F,F,F,F,F,F,L,F,F,i,i,i,r,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,r,r,r,r,r,r,r,F,t,r,r,r,r,r,r,i,i,r,r,t,r,r,r,r,i,i,_,_,_,_,_,_,_,_,_,_,i,i,i,i,i,i],[i,i,i,i,i,i,i,i,i,i,i,i,i,i,t,i,i,r,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,t,t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,r,r,r,r,r,r,r,r,r,r,r,i,t,t,t,t,t,t,t,t,t,t,t,t,t,t,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,r,r,r,r,r,r,r,r,r,x,x,t,t,t,t,x,t,t,t,t,t],[O,O,O,O,O,O,O,O,O,O,O,p,p,p,s,x,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,O,et,Ei,Mi,$i,Pi,Ii,W,L,L,L,L,L,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,W,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,O,p,p,p,p,p,t,t,t,t,t,p,p,p,p,p,p,_,s,t,t,_,_,_,_,_,_,K,K,t,t,t,s,_,_,_,_,_,_,_,_,_,_,K,K,t,t,t,t,s,s,s,s,s,s,s,s,s,s,s,s,s,t,t,t,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t],[s,s,s,s,s,s,s,t,t,t,t,t,t,t,t,t,t,t,t,s,s,s,s,s,t,t,t,t,t,x,r,x,x,x,x,x,x,x,x,x,x,K,x,x,x,x,x,x,x,x,x,x,x,x,x,t,x,x,x,x,x,t,x,t,x,x,t,x,x,t,x,x,x,x,x,x,x,x,x,x,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,r,r,r,r,r,r,r,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,W,t,W,t,t,W,t,t,t,t,t,t,t,t,t,L,t,t,K,K,t,t,t,t,t,L,L,t,t,t,t,t,i,i,i,i,i,t,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,i,t,t,p],[t,t,t,L,L,L,t,t,t,t,t,K,W,K,W,W,_,_,_,_,_,_,_,_,_,_,W,t,t,t,t,t,t,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,t,t,t,t,t,t,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,t,t,t,t,t,t,t,t,t,t,t,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,t,t,t,s,s,s,s,s,s,t,t,s,s,s,s,s,s,t,t,s,s,s,s,s,s,t,t,s,s,s,t,t,t,L,L,t,t,t,L,L,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t]];class Ts{constructor(){this.inputFormat="ILYNN",this.outputFormat="VLNNN",this.sourceToTarget=[],this.targetToSource=[],this.levels=[]}bidiTransform(e,n,l){if(this.sourceToTarget=[],this.targetToSource=[],!e)return"";if(es(this.sourceToTarget,this.targetToSource,e.length),!this.checkParameters(n,l))return e;n=this.inputFormat,l=this.outputFormat;let a=e;const o=hs,u=hi(n.charAt(1)),f=hi(l.charAt(1)),c=(n.charAt(0)==="I"?"L":n.charAt(0))+u,d=(l.charAt(0)==="I"?"L":l.charAt(0))+f,A=n.charAt(2)+l.charAt(2);o.defInFormat=c,o.defOutFormat=d,o.defSwap=A;const B=bt(e,c,d,A,o);let w=!1;return l.charAt(1)==="R"?w=!0:l.charAt(1)!=="C"&&l.charAt(1)!=="D"||(w=this.checkContextual(B)==="rtl"),this.sourceToTarget=Q,this.targetToSource=ns(this.sourceToTarget),zt=this.targetToSource,a=n.charAt(3)===l.charAt(3)?B:l.charAt(3)==="S"?ji(w,B,!0):qi(B,w,!0),this.sourceToTarget=Q,this.targetToSource=zt,this.levels=Wt,a}_inputFormatSetter(e){if(!ri.test(e))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=e}_outputFormatSetter(e){if(!ri.test(e))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=e}checkParameters(e,n){return e?this._inputFormatSetter(e):e=this.inputFormat,n?this._outputFormatSetter(n):n=this.outputFormat,e!==n}checkContextual(e){let n=jt(e);if(n!=="ltr"&&n!=="rtl"){try{n=document.dir.toLowerCase()}catch{}n!=="ltr"&&n!=="rtl"&&(n="ltr")}return n}hasBidiChar(e){return as.test(e)}}function bt(h,e,n,l,a){const o=Oi(h,{inFormat:e,outFormat:n,swap:l},a);if(o.inFormat===o.outFormat)return h;e=o.inFormat,n=o.outFormat,l=o.swap;const u=e.substring(0,1),f=e.substring(1,4),c=n.substring(0,1),d=n.substring(1,4);if(a.inFormat=e,a.outFormat=n,a.swap=l,u==="L"&&n==="VLTR"){if(f==="LTR")return a.dir=wt,ct(h,a);if(f==="RTL")return a.dir=Bt,ct(h,a)}if(u==="V"&&c==="V")return a.dir=f==="RTL"?Bt:wt,Gt(h,a);if(u==="L"&&n==="VRTL")return f==="LTR"?(a.dir=wt,h=ct(h,a)):(a.dir=Bt,h=ct(h,a)),Gt(h);if(e==="VLTR"&&n==="LLTR")return a.dir=wt,ct(h,a);if(u==="V"&&c==="L"&&f!==d)return h=Gt(h),f==="RTL"?bt(h,"LLTR","VLTR",l,a):bt(h,"LRTL","VRTL",l,a);if(e==="VRTL"&&n==="LRTL")return bt(h,"LRTL","VRTL",l,a);if(u==="L"&&c==="L"){const A=a.swap;return a.swap=A.substr(0,1)+"N",f==="RTL"?(a.dir=Bt,h=ct(h,a),a.swap="N"+A.substr(1,2),a.dir=wt,h=ct(h,a)):(a.dir=wt,h=ct(h,a),a.swap="N"+A.substr(1,2),h=bt(h,"VLTR","LRTL",a.swap,a)),h}return h}function Oi(h,e,n){if(e.inFormat===void 0&&(e.inFormat=n.defInFormat),e.outFormat===void 0&&(e.outFormat=n.defOutFormat),e.swap===void 0&&(e.swap=n.defSwap),e.inFormat===e.outFormat)return e;const l=e.inFormat.substring(0,1),a=e.outFormat.substring(0,1);let o,u=e.inFormat.substring(1,4),f=e.outFormat.substring(1,4);return u.charAt(0)==="C"&&(o=jt(h),u=o==="ltr"||o==="rtl"?o.toUpperCase():e.inFormat.charAt(2)==="L"?"LTR":"RTL",e.inFormat=l+u),f.charAt(0)==="C"&&(o=jt(h),o==="rtl"?f="RTL":o==="ltr"?(o=Wi(h),f=o.toUpperCase()):f=e.outFormat.charAt(2)==="L"?"LTR":"RTL",e.outFormat=a+f),e}function ji(h,e,n){if(e.length===0)return"";h===void 0&&(h=!0),n===void 0&&(n=!0);const l=(e=String(e)).split("");let a=0,o=1,u=l.length;h||(a=l.length-1,o=-1,u=1);const f=zi(l,a,o,u,n);let c="";for(let d=0;d<l.length;d++)n&&Ji(f,f.length,d)>-1?(ui(zt,d,!h,-1),Q.splice(d,1)):c+=l[d];return c}function zi(h,e,n,l,a){let o=0;const u=[];let f=0;for(let c=e;c*n<l;c+=n)if(xi(h[c])||Ut(h[c])){if(h[c]==="\u0644"&&Zi(h,c+n,n,l)){h[c]=ss(h[c+n],o===0?vi:Ai),c+=n,is(h,c,n,l),a&&(u[f]=c,f++),o=0;continue}const d=h[c];o===1?h[c]=ei(h,c+n,n,l)?ts(h[c]):Ht(h[c],bi):ei(h,c+n,n,l)===!0?h[c]=Ht(h[c],Ui):h[c]=Ht(h[c],Ri),Ut(d)||(o=1),Ki(d)===!0&&(o=0)}else o=0;return u}function jt(h){const e=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(h);return e?e[0]<="z"?"ltr":"rtl":""}function Wi(h){const e=h.split("");return e.reverse(),jt(e.join(""))}function qi(h,e,n){if(h.length===0)return"";n===void 0&&(n=!0),e===void 0&&(e=!0);let l="";const a=(h=String(h)).split("");for(let o=0;o<h.length;o++){let u=!1;if(a[o]>="\uFE70"&&a[o]<"\uFEFF"){const f=h.charCodeAt(o);a[o]>="\uFEF5"&&a[o]<="\uFEFC"?(e?(o>0&&n&&a[o-1]===" "?l=l.substring(0,l.length-1)+"\u0644":(l+="\u0644",u=!0),l+=vt[(f-65269)/2]):(l+=vt[(f-65269)/2],l+="\u0644",o+1<h.length&&n&&a[o+1]===" "?o++:u=!0),u&&(ui(zt,o,!0,1),Q.splice(o,0,Q[o]))):l+=Ni[f-65136]}else l+=a[o]}return l}function ct(h,e){const n=h.split(""),l=[];return oi(n,l,e),Xi(n,l,e),ni(2,n,l,e),ni(1,n,l,e),Wt=l,n.join("")}function oi(h,e,n){const l=h.length,a=n.dir?Vi:Si;let o=0,u=-1;const f=[],c=[];n.hiLevel=n.dir,n.lastArabic=!1,n.hasUbatAl=!1,n.hasUbatB=!1,n.hasUbatS=!1;for(let d=0;d<l;d++)f[d]=Yi(h[d]);for(let d=0;d<l;d++){const A=o,B=Gi(h,f,c,d,n);c[d]=B,o=a[A][B];const w=240&o;o&=15;const v=a[o][rs];if(e[d]=v,w>0)if(w===16){for(let g=u;g<d;g++)e[g]=1;u=-1}else u=-1;if(a[o][ls])u===-1&&(u=d);else if(u>-1){for(let g=u;g<d;g++)e[g]=v;u=-1}f[d]===et&&(e[d]=0),n.hiLevel|=v}n.hasUbatS&&Qi(f,e,l,n)}function Qi(h,e,n,l){for(let a=0;a<n;a++)if(h[a]===Ct){e[a]=l.dir;for(let o=a-1;o>=0&&h[o]===O;o--)e[o]=l.dir}}function Xi(h,e,n){if(n.hiLevel!==0&&n.swap.substr(0,1)!==n.swap.substr(1,2))for(let l=0;l<h.length;l++)e[l]===1&&(h[l]=Hi(h[l]))}function Yi(h){const e=h.charCodeAt(0),n=Di[e>>8];return n<st?n:Ci[n-st][255&e]}function Gt(h,e){const n=h.split("");if(e){const l=[];oi(n,l,e),Wt=l}return n.reverse(),Q.reverse(),n.join("")}function Ji(h,e,n){for(let l=0;l<e;l++)if(h[l]===n)return l;return-1}function xi(h){for(let e=0;e<si.length;e++)if(h>=si[e]&&h<=Fi[e])return!0;return!1}function ei(h,e,n,l){for(;e*n<l&&Ut(h[e]);)e+=n;return!!(e*n<l&&xi(h[e]))}function Zi(h,e,n,l){for(;e*n<l&&Ut(h[e]);)e+=n;let a=" ";if(!(e*n<l))return!1;a=h[e];for(let o=0;o<vt.length;o++)if(vt[o]===a)return!0;return!1}function ni(h,e,n,l){if(l.hiLevel<h)return;if(h===1&&l.dir===Bt&&!l.hasUbatB)return e.reverse(),void Q.reverse();const a=e.length;let o,u,f,c,d,A=0;for(;A<a;){if(n[A]>=h){for(o=A+1;o<a&&n[o]>=h;)o++;for(u=A,f=o-1;u<f;u++,f--)c=e[u],e[u]=e[f],e[f]=c,d=Q[u],Q[u]=Q[f],Q[f]=d;A=o}A++}}function Gi(h,e,n,l,a){const o=e[l];return{UBAT_L:()=>(a.lastArabic=!1,s),UBAT_R:()=>(a.lastArabic=!1,x),UBAT_ON:()=>t,UBAT_AN:()=>F,UBAT_EN:()=>a.lastArabic?F:_,UBAT_AL:()=>(a.lastArabic=!0,a.hasUbatAl=!0,x),UBAT_WS:()=>t,UBAT_CS:()=>{let u,f;return l<1||l+1>=e.length||(u=n[l-1])!==_&&u!==F||(f=e[l+1])!==_&&f!==F?t:(a.lastArabic&&(f=F),f===u?f:t)},UBAT_ES:()=>(l>0?n[l-1]:et)===_&&l+1<e.length&&e[l+1]===_?_:t,UBAT_ET:()=>{if(l>0&&n[l-1]===_)return _;if(a.lastArabic)return t;let u=l+1;const f=e.length;for(;u<f&&e[u]===L;)u++;return u<f&&e[u]===_?_:t},UBAT_NSM:()=>{if(a.inFormat==="VLTR"){const u=e.length;let f=l+1;for(;f<u&&e[f]===r;)f++;if(f<u){const c=h[l].charCodeAt[0],d=c>=1425&&c<=2303||c===64286,A=e[f];if(d&&(A===x||A===i))return x}}return l<1||e[l-1]===et?t:n[l-1]},UBAT_B:()=>(a.lastArabic=!0,a.hasUbatB=!0,a.dir),UBAT_S:()=>(a.hasUbatS=!0,t),UBAT_LRE:()=>(a.lastArabic=!1,t),UBAT_RLE:()=>(a.lastArabic=!1,t),UBAT_LRO:()=>(a.lastArabic=!1,t),UBAT_RLO:()=>(a.lastArabic=!1,t),UBAT_PDF:()=>(a.lastArabic=!1,t),UBAT_BN:()=>t}[ki[o]]()}function Hi(h){let e,n=0,l=It.length-1;for(;n<=l;)if(e=Math.floor((n+l)/2),h<It[e][0])l=e-1;else{if(!(h>It[e][0]))return It[e][1];n=e+1}return h}function Ki(h){for(let e=0;e<ii.length;e++)if(ii[e]===h)return!0;return!1}function ts(h){for(let e=0;e<Ot.length;e++)if(h===Ot[e])return Bi[e];return h}function Ht(h,e){for(let n=0;n<Ot.length;n++)if(h===Ot[n])return e[n];return h}function Ut(h){return h>="\u064B"&&h<="\u0655"}function hi(h){return h==="L"?"LTR":h==="R"?"RTL":h==="C"?"CLR":h==="D"?"CRL":""}function is(h,e,n,l){for(;e*n<l&&Ut(h[e]);)e+=n;return e*n<l&&(h[e]=" ",!0)}function ss(h,e){for(let n=0;n<vt.length;n++)if(h===vt[n])return e[n];return h}function es(h,e,n){Q=[],Wt=[];for(let l=0;l<n;l++)h[l]=l,e[l]=l,Q[l]=l}function ns(h){const e=new Array(h.length);for(let n=0;n<h.length;n++)e[h[n]]=n;return e}function ui(h,e,n,l){for(let a=0;a<h.length;a++)(h[a]>e||!n&&h[a]===e)&&(h[a]+=l)}let Q=[],zt=[],Wt=[];const hs={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},rs=5,ls=6,wt=0,Bt=1,ri=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,as=/[\u0591-\u06ff\ufb1d-\ufefc]/,os=Math.PI,xs=128/os,us=256/360;function yi(h,e){return(h%=e)>=0?h:h+e}function _s(h){return yi(h*xs,256)}function Ls(h){return yi(h*us,256)}function kt(h,e,n){return h>=e&&h<=n||h>=n&&h<=e}class Dt{constructor(e,n,l){this.ratio=e,this.x=n,this.y=l}}class ws{constructor(e,n,l,a=8,o=8){this.lines=[],this.starts=[],this.validateTessellation=!0,this.pixelRatio=a,this.pixelMargin=o,this.tileSize=pi*a,this.dz=e,this.yPos=n,this.xPos=l}setPixelMargin(e){e!==this.pixelMargin&&(this.pixelMargin=e,this.setExtent(this._extent))}setExtent(e){this._extent=e,this.finalRatio=this.tileSize/e*(1<<this.dz);let n=this.pixelRatio*this.pixelMargin;n/=this.finalRatio;const l=e>>this.dz;n>l&&(n=l),this.margin=n,this.xmin=l*this.xPos-n,this.ymin=l*this.yPos-n,this.xmax=this.xmin+l+2*n,this.ymax=this.ymin+l+2*n}reset(e){this.type=e,this.lines=[],this.starts=[],this.line=null,this.start=0}moveTo(e,n){this._pushLine(),this._prevIsIn=this._isIn(e,n),this._moveTo(e,n,this._prevIsIn),this._prevPt=new Y(e,n),this._firstPt=new Y(e,n),this._dist=0}lineTo(e,n){const l=this._isIn(e,n),a=new Y(e,n),o=Y.distance(this._prevPt,a);let u,f,c,d,A,B,w,v;if(l)this._prevIsIn?this._lineTo(e,n,!0):(u=this._prevPt,f=a,c=this._intersect(f,u),this.start=this._dist+o*(1-this._r),this._lineTo(c.x,c.y,!0),this._lineTo(f.x,f.y,!0));else if(this._prevIsIn)f=this._prevPt,u=a,c=this._intersect(f,u),this._lineTo(c.x,c.y,!0),this._lineTo(u.x,u.y,!1);else{const g=this._prevPt,T=a;if(g.x<=this.xmin&&T.x<=this.xmin||g.x>=this.xmax&&T.x>=this.xmax||g.y<=this.ymin&&T.y<=this.ymin||g.y>=this.ymax&&T.y>=this.ymax)this._lineTo(T.x,T.y,!1);else{const R=[];if((g.x<this.xmin&&T.x>this.xmin||g.x>this.xmin&&T.x<this.xmin)&&(d=(this.xmin-g.x)/(T.x-g.x),v=g.y+d*(T.y-g.y),v<=this.ymin?B=!1:v>=this.ymax?B=!0:R.push(new Dt(d,this.xmin,v))),(g.x<this.xmax&&T.x>this.xmax||g.x>this.xmax&&T.x<this.xmax)&&(d=(this.xmax-g.x)/(T.x-g.x),v=g.y+d*(T.y-g.y),v<=this.ymin?B=!1:v>=this.ymax?B=!0:R.push(new Dt(d,this.xmax,v))),(g.y<this.ymin&&T.y>this.ymin||g.y>this.ymin&&T.y<this.ymin)&&(d=(this.ymin-g.y)/(T.y-g.y),w=g.x+d*(T.x-g.x),w<=this.xmin?A=!1:w>=this.xmax?A=!0:R.push(new Dt(d,w,this.ymin))),(g.y<this.ymax&&T.y>this.ymax||g.y>this.ymax&&T.y<this.ymax)&&(d=(this.ymax-g.y)/(T.y-g.y),w=g.x+d*(T.x-g.x),w<=this.xmin?A=!1:w>=this.xmax?A=!0:R.push(new Dt(d,w,this.ymax))),R.length===0)A?B?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):B?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(R.length>1&&R[0].ratio>R[1].ratio)this.start=this._dist+o*R[1].ratio,this._lineTo(R[1].x,R[1].y,!0),this._lineTo(R[0].x,R[0].y,!0);else{this.start=this._dist+o*R[0].ratio;for(let b=0;b<R.length;b++)this._lineTo(R[b].x,R[b].y,!0)}this._lineTo(T.x,T.y,!1)}}this._dist+=o,this._prevIsIn=l,this._prevPt=a}close(){if(this.line.length>2){const e=this._firstPt,n=this._prevPt;e.x===n.x&&e.y===n.y||this.lineTo(e.x,e.y);const l=this.line;let a=l.length;for(;a>=4&&(l[0].x===l[1].x&&l[0].x===l[a-2].x||l[0].y===l[1].y&&l[0].y===l[a-2].y);)l.pop(),l[0].x=l[a-2].x,l[0].y=l[a-2].y,--a}}result(e=!0){return this._pushLine(),this.lines.length===0?null:(this.type===dt.Polygon&&e&&ot.simplify(this.tileSize,this.margin*this.finalRatio,this.lines),this.lines)}resultWithStarts(){if(this.type!==dt.LineString)throw new Error("Only valid for lines");this._pushLine();const e=this.lines,n=e.length;if(n===0)return null;const l=[];for(let a=0;a<n;a++)l.push({line:e[a],start:this.starts[a]||0});return l}_isIn(e,n){return e>=this.xmin&&e<=this.xmax&&n>=this.ymin&&n<=this.ymax}_intersect(e,n){let l,a,o;if(n.x>=this.xmin&&n.x<=this.xmax)a=n.y<=this.ymin?this.ymin:this.ymax,o=(a-e.y)/(n.y-e.y),l=e.x+o*(n.x-e.x);else if(n.y>=this.ymin&&n.y<=this.ymax)l=n.x<=this.xmin?this.xmin:this.xmax,o=(l-e.x)/(n.x-e.x),a=e.y+o*(n.y-e.y);else{a=n.y<=this.ymin?this.ymin:this.ymax,l=n.x<=this.xmin?this.xmin:this.xmax;const u=(l-e.x)/(n.x-e.x),f=(a-e.y)/(n.y-e.y);u<f?(o=u,a=e.y+u*(n.y-e.y)):(o=f,l=e.x+f*(n.x-e.x))}return this._r=o,new Y(l,a)}_pushLine(){this.line&&(this.type===dt.Point?this.line.length>0&&(this.lines.push(this.line),this.starts.push(this.start)):this.type===dt.LineString?this.line.length>1&&(this.lines.push(this.line),this.starts.push(this.start)):this.type===dt.Polygon&&this.line.length>3&&(this.lines.push(this.line),this.starts.push(this.start))),this.line=[],this.start=0}_moveTo(e,n,l){this.type!==dt.Polygon?l&&(e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),n=Math.round((n-(this.ymin+this.margin))*this.finalRatio),this.line.push(new Y(e,n))):(l||(e<this.xmin&&(e=this.xmin),e>this.xmax&&(e=this.xmax),n<this.ymin&&(n=this.ymin),n>this.ymax&&(n=this.ymax)),e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),n=Math.round((n-(this.ymin+this.margin))*this.finalRatio),this.line.push(new Y(e,n)),this._is_h=!1,this._is_v=!1)}_lineTo(e,n,l){let a,o;if(this.type!==dt.Polygon)if(l){if(e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),n=Math.round((n-(this.ymin+this.margin))*this.finalRatio),this.line.length>0&&(a=this.line[this.line.length-1],a.equals(e,n)))return;this.line.push(new Y(e,n))}else this.line&&this.line.length>0&&this._pushLine();else if(l||(e<this.xmin&&(e=this.xmin),e>this.xmax&&(e=this.xmax),n<this.ymin&&(n=this.ymin),n>this.ymax&&(n=this.ymax)),e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),n=Math.round((n-(this.ymin+this.margin))*this.finalRatio),this.line&&this.line.length>0){a=this.line[this.line.length-1];const u=a.x===e,f=a.y===n;if(u&&f)return;this._is_h&&u||this._is_v&&f?(a.x=e,a.y=n,o=this.line[this.line.length-2],o.x===e&&o.y===n?(this.line.pop(),this.line.length<=1?(this._is_h=!1,this._is_v=!1):(o=this.line[this.line.length-2],this._is_h=o.x===e,this._is_v=o.y===n)):(this._is_h=o.x===e,this._is_v=o.y===n)):(this.line.push(new Y(e,n)),this._is_h=u,this._is_v=f)}else this.line.push(new Y(e,n))}}class vs{setExtent(e){this._ratio=e===4096?1:4096/e}get validateTessellation(){return this._ratio<1}reset(e){this.lines=[],this.line=null}moveTo(e,n){this.line&&this.lines.push(this.line),this.line=[];const l=this._ratio;this.line.push(new Y(e*l,n*l))}lineTo(e,n){const l=this._ratio;this.line.push(new Y(e*l,n*l))}close(){const e=this.line;e&&!e[0].isEqual(e[e.length-1])&&e.push(e[0])}result(){return this.line&&this.lines.push(this.line),this.lines.length===0?null:this.lines}}var D;(function(h){h[h.sideLeft=0]="sideLeft",h[h.sideRight=1]="sideRight",h[h.sideTop=2]="sideTop",h[h.sideBottom=3]="sideBottom"})(D||(D={}));class ot{static simplify(e,n,l){if(!l)return;const a=-n,o=e+n,u=-n,f=e+n,c=[],d=[],A=l.length;for(let w=0;w<A;++w){const v=l[w];if(!v||v.length<2)continue;let g,T=v[0];const R=v.length;for(let b=1;b<R;++b)g=v[b],T.x===g.x&&(T.x<=a&&(T.y>g.y?(c.push(w),c.push(b),c.push(D.sideLeft),c.push(-1)):(d.push(w),d.push(b),d.push(D.sideLeft),d.push(-1))),T.x>=o&&(T.y<g.y?(c.push(w),c.push(b),c.push(D.sideRight),c.push(-1)):(d.push(w),d.push(b),d.push(D.sideRight),d.push(-1)))),T.y===g.y&&(T.y<=u&&(T.x<g.x?(c.push(w),c.push(b),c.push(D.sideTop),c.push(-1)):(d.push(w),d.push(b),d.push(D.sideTop),d.push(-1))),T.y>=f&&(T.x>g.x?(c.push(w),c.push(b),c.push(D.sideBottom),c.push(-1)):(d.push(w),d.push(b),d.push(D.sideBottom),d.push(-1)))),T=g}if(c.length===0||d.length===0)return;ot.fillParent(l,d,c),ot.fillParent(l,c,d);const B=[];ot.calcDeltas(B,d,c),ot.calcDeltas(B,c,d),ot.addDeltas(B,l)}static fillParent(e,n,l){const a=l.length,o=n.length;for(let u=0;u<o;u+=4){const f=n[u],c=n[u+1],d=n[u+2],A=e[f][c-1],B=e[f][c];let w=8092,v=-1;for(let g=0;g<a;g+=4){if(l[g+2]!==d)continue;const T=l[g],R=l[g+1],b=e[T][R-1],m=e[T][R];switch(d){case D.sideLeft:case D.sideRight:if(kt(A.y,b.y,m.y)&&kt(B.y,b.y,m.y)){const y=Math.abs(m.y-b.y);y<w&&(w=y,v=g)}break;case D.sideTop:case D.sideBottom:if(kt(A.x,b.x,m.x)&&kt(B.x,b.x,m.x)){const y=Math.abs(m.x-b.x);y<w&&(w=y,v=g)}}}n[u+3]=v}}static calcDeltas(e,n,l){const a=n.length;for(let o=0;o<a;o+=4){const u=[],f=ot.calcDelta(o,n,l,u);e.push(n[o]),e.push(n[o+1]),e.push(n[o+2]),e.push(f)}}static calcDelta(e,n,l,a){const o=n[e+3];if(o===-1)return 0;const u=a.length;return u>1&&a[u-2]===o?0:(a.push(o),ot.calcDelta(o,l,n,a)+1)}static addDeltas(e,n){const l=e.length;let a=0;for(let o=0;o<l;o+=4){const u=e[o+3];u>a&&(a=u)}for(let o=0;o<l;o+=4){const u=n[e[o]],f=e[o+1],c=a-e[o+3];switch(e[o+2]){case D.sideLeft:u[f-1].x-=c,u[f].x-=c,f===1&&(u[u.length-1].x-=c),f===u.length-1&&(u[0].x-=c);break;case D.sideRight:u[f-1].x+=c,u[f].x+=c,f===1&&(u[u.length-1].x+=c),f===u.length-1&&(u[0].x+=c);break;case D.sideTop:u[f-1].y-=c,u[f].y-=c,f===1&&(u[u.length-1].y-=c),f===u.length-1&&(u[0].y-=c);break;case D.sideBottom:u[f-1].y+=c,u[f].y+=c,f===1&&(u[u.length-1].y+=c),f===u.length-1&&(u[0].y+=c)}}}}export{Ts as C,Ls as M,ds as a,ps as d,_s as h,vs as l,ws as n,gs as r,ms as t};
